import React, { useContext, useEffect, useState } from "react";
import Link from "next/link";
import { useRouter } from "next/router";
import SVG from "./SVG";
import { BasketContext } from "../../context/BasketContext";

interface IMenu {
  name: string;
  path: string;
  icon: JSX.Element;
  label: string;
}
function MobileNavigation(props) {
  const router = useRouter();
  const { basket } = useContext(BasketContext);
  const [quantity, setQuantity] = useState(0);
  useEffect(() => {
    if (!!basket) {
      let quantityData = 0;
      basket.lines.map((line) => {
        quantityData += line.quantity;
      });
      setQuantity(quantityData);
    }
  }, [basket]);
  const menu: IMenu[] = [
    {
      name: "Главная",
      path: "/",
      icon: (
        <svg viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M23.2012 24H17.0128C16.5679 24 16.2038 23.636 16.2038 23.1911V19.3486C16.2038 18.3779 15.4353 17.6094 14.4646 17.6094C13.4939 17.6094 12.7254 18.3779 12.7254 19.3486V23.1911C12.7254 23.636 12.3614 24 11.9164 24H5.80894C5.36402 24 5 23.636 5 23.1911V12.8366C5 12.1086 5.36402 11.421 5.93028 11.0165L14.0601 5.15168C14.3433 4.94944 14.7073 4.94944 14.9904 5.15168L23.1203 11.0165C23.6865 11.421 24.0506 12.1086 24.0506 12.8366V23.2315C24.0101 23.636 23.6461 24 23.2012 24ZM17.8217 22.4226H22.4327V12.8366C22.4327 12.6344 22.3113 12.4321 22.1495 12.3108L14.5051 6.76956L6.86056 12.2704C6.69878 12.3917 6.57744 12.5939 6.57744 12.7962V22.3821H11.1884V19.3486C11.1884 17.5285 12.6849 16.0319 14.5051 16.0319C16.3252 16.0319 17.8217 17.5285 17.8217 19.3486V22.4226Z"
            fill="none"
          />
        </svg>
      ),
      label: "Ссылка на главную",
    },
    {
      name: "Каталог",
      path: "/catalog",
      icon: (
        <svg
          viewBox="0 0 20 17"
          fill="#A999EB"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M15.8845 11.0368C16.6028 10.1279 16.9956 9.00444 17.0001 7.84601C17.0001 6.81146 16.6933 5.80014 16.1186 4.93995C15.5438 4.07975 14.7269 3.40931 13.7711 3.01341C12.8153 2.6175 11.7635 2.51391 10.7489 2.71574C9.73421 2.91758 8.80217 3.41576 8.07063 4.14729C7.3391 4.87883 6.84091 5.81087 6.63908 6.82554C6.43725 7.84021 6.54084 8.89194 6.93675 9.84774C7.33265 10.8035 8.00309 11.6205 8.86329 12.1952C9.72348 12.77 10.7348 13.0768 11.7693 13.0768C12.9278 13.0723 14.0512 12.6795 14.9601 11.9612L18.4997 15.5006C18.623 15.6197 18.7881 15.6856 18.9596 15.6841C19.131 15.6826 19.295 15.6139 19.4162 15.4926C19.5375 15.3714 19.6062 15.2074 19.6077 15.036C19.6092 14.8645 19.5433 14.6994 19.4242 14.5761L15.8845 11.0368ZM7.84627 7.84601C7.84627 7.0701 8.07635 6.31161 8.50743 5.66646C8.9385 5.02132 9.5512 4.51849 10.2681 4.22156C10.9849 3.92463 11.7737 3.84694 12.5347 3.99831C13.2957 4.14968 13.9947 4.52332 14.5434 5.07197C15.092 5.62063 15.4657 6.31965 15.617 7.08065C15.7684 7.84166 15.6907 8.63046 15.3938 9.34731C15.0969 10.0642 14.594 10.6769 13.9489 11.1079C13.3037 11.539 12.5453 11.7691 11.7693 11.7691C10.7292 11.7679 9.73205 11.3543 8.99657 10.6188C8.2611 9.88331 7.84741 8.88612 7.84627 7.84601Z"
            fill="#A999EB"
          />
          <path
            d="M18.9616 0H0.653847C0.480436 0 0.314127 0.0688872 0.191507 0.191507C0.0688872 0.314127 0 0.480436 0 0.653847C0 0.827257 0.0688872 0.993566 0.191507 1.11619C0.314127 1.23881 0.480436 1.30769 0.653847 1.30769H18.9616C19.135 1.30769 19.3013 1.23881 19.4239 1.11619C19.5465 0.993566 19.6154 0.827257 19.6154 0.653847C19.6154 0.480436 19.5465 0.314127 19.4239 0.191507C19.3013 0.0688872 19.135 0 18.9616 0Z"
            fill="#A999EB"
          />
          <path
            d="M0.653847 9.15413H4.57693C4.75034 9.15413 4.91665 9.08524 5.03927 8.96262C5.16189 8.84 5.23077 8.67369 5.23077 8.50028C5.23077 8.32687 5.16189 8.16056 5.03927 8.03794C4.91665 7.91532 4.75034 7.84644 4.57693 7.84644H0.653847C0.480436 7.84644 0.314127 7.91532 0.191507 8.03794C0.0688872 8.16056 0 8.32687 0 8.50028C0 8.67369 0.0688872 8.84 0.191507 8.96262C0.314127 9.08524 0.480436 9.15413 0.653847 9.15413Z"
            fill="#A999EB"
          />
          <path
            d="M0.653847 13.077H4.57693C4.75034 13.077 4.91665 13.0081 5.03927 12.8855C5.16189 12.7629 5.23077 12.5965 5.23077 12.4231C5.23077 12.2497 5.16189 12.0834 5.03927 11.9608C4.91665 11.8382 4.75034 11.7693 4.57693 11.7693H0.653847C0.480436 11.7693 0.314127 11.8382 0.191507 11.9608C0.0688872 12.0834 0 12.2497 0 12.4231C0 12.5965 0.0688872 12.7629 0.191507 12.8855C0.314127 13.0081 0.480436 13.077 0.653847 13.077Z"
            fill="#A999EB"
          />
          <path
            d="M0.653847 16.9998H15.0385C15.2119 16.9998 15.3782 16.9309 15.5008 16.8083C15.6234 16.6857 15.6923 16.5194 15.6923 16.346C15.6923 16.1726 15.6234 16.0063 15.5008 15.8836C15.3782 15.761 15.2119 15.6921 15.0385 15.6921H0.653847C0.480436 15.6921 0.314127 15.761 0.191507 15.8836C0.0688872 16.0063 0 16.1726 0 16.346C0 16.5194 0.0688872 16.6857 0.191507 16.8083C0.314127 16.9309 0.480436 16.9998 0.653847 16.9998Z"
            fill="#A999EB"
          />
          <path
            d="M0.653847 5.23079H4.57693C4.75034 5.23079 4.91665 5.1619 5.03927 5.03928C5.16189 4.91666 5.23077 4.75035 5.23077 4.57694C5.23077 4.40353 5.16189 4.23722 5.03927 4.1146C4.91665 3.99198 4.75034 3.9231 4.57693 3.9231H0.653847C0.480436 3.9231 0.314127 3.99198 0.191507 4.1146C0.0688872 4.23722 0 4.40353 0 4.57694C0 4.75035 0.0688872 4.91666 0.191507 5.03928C0.314127 5.1619 0.480436 5.23079 0.653847 5.23079Z"
            fill="#A999EB"
          />
        </svg>
      ),
      label: "Ссылка на каталог",
    },
    {
      name: "Корзина",
      path: "/basket",
      icon: (
        <svg viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M11.5066 19.9877H22.4678C22.9104 19.9877 23.3153 19.6393 23.3153 19.1402C23.3153 18.6505 22.9104 18.3021 22.4678 18.3021H11.7231C11.2711 18.3021 10.9886 17.9913 10.9227 17.5111L10.7815 16.5317H22.5431C23.9839 16.5317 24.7467 15.6559 24.9538 14.2246L25.6601 9.50673C25.6789 9.38431 25.6978 9.22423 25.6978 9.12064C25.6978 8.56505 25.3117 8.18837 24.6619 8.18837H9.56669L9.42543 7.17135C9.30301 6.35209 8.97342 5.93774 7.92815 5.93774H4.69817C4.22733 5.93774 3.81299 6.35209 3.81299 6.83235C3.81299 7.32202 4.22733 7.73636 4.69817 7.73636H7.64565L9.10526 17.6994C9.31243 19.1213 10.0658 19.9877 11.5066 19.9877ZM23.739 9.87399L23.1458 14.0551C23.0705 14.5353 22.8162 14.8367 22.3548 14.8367L10.5366 14.8461L9.81152 9.87399H23.739ZM12.2787 24.7149C13.1922 24.7149 13.9267 23.9804 13.9267 23.067C13.9267 22.1536 13.1922 21.419 12.2787 21.419C11.3653 21.419 10.6308 22.1536 10.6308 23.067C10.6308 23.9804 11.3653 24.7149 12.2787 24.7149ZM20.9799 24.7149C21.8933 24.7149 22.6184 23.9804 22.6184 23.067C22.6184 22.1536 21.8933 21.419 20.9799 21.419C20.0665 21.419 19.3225 22.1536 19.3225 23.067C19.3225 23.9804 20.0665 24.7149 20.9799 24.7149Z"
            fill="#A999EB"
          />
        </svg>
      ),
      label: "Ссылка на корзину",
    },
    {
      name: "Избранное",
      path: "/favourite",
      icon: (
        <svg viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M22.6402 9.3749C21.7127 8.44496 20.4832 7.87737 19.1738 7.77467C17.8644 7.67198 16.5614 8.04093 15.5002 8.8149C14.3869 7.98683 13.0012 7.61135 11.6222 7.76406C10.2431 7.91677 8.97313 8.58633 8.06797 9.63791C7.16281 10.6895 6.68971 12.045 6.74394 13.4314C6.79817 14.8178 7.37571 16.1322 8.36024 17.1099L13.794 22.5524C14.249 23.0002 14.8618 23.2512 15.5002 23.2512C16.1387 23.2512 16.7515 23.0002 17.2065 22.5524L22.6402 17.1099C23.6619 16.082 24.2353 14.6916 24.2353 13.2424C24.2353 11.7932 23.6619 10.4028 22.6402 9.3749ZM21.4065 15.9024L15.9727 21.3362C15.9109 21.3986 15.8373 21.4481 15.7562 21.482C15.6751 21.5158 15.5881 21.5332 15.5002 21.5332C15.4124 21.5332 15.3254 21.5158 15.2443 21.482C15.1632 21.4481 15.0896 21.3986 15.0277 21.3362L9.59399 15.8762C8.90778 15.1747 8.52352 14.2324 8.52352 13.2512C8.52352 12.2699 8.90778 11.3276 9.59399 10.6262C10.2933 9.93577 11.2363 9.54865 12.219 9.54865C13.2016 9.54865 14.1447 9.93577 14.844 10.6262C14.9253 10.7082 15.0221 10.7733 15.1287 10.8177C15.2354 10.8621 15.3497 10.885 15.4652 10.885C15.5808 10.885 15.6951 10.8621 15.8017 10.8177C15.9084 10.7733 16.0051 10.7082 16.0865 10.6262C16.7858 9.93577 17.7288 9.54865 18.7115 9.54865C19.6941 9.54865 20.6372 9.93577 21.3365 10.6262C22.0321 11.3184 22.429 12.2556 22.4421 13.2369C22.4552 14.2182 22.0834 15.1656 21.4065 15.8762V15.9024Z"
            fill="#A999EB"
          />
        </svg>
      ),
      label: "Ссылка на избранное",
    },
  ];
  return (
    <section className="mobile-nav">
      <div className="mobile-nav__container">
        <menu className="mobile-nav__menu">
          <ul className="mobile-nav__list">
            {menu.map((menuItem, id) => (
              <li
                key={menuItem.path + id}
                className={
                  "mobile-nav__list-item " +
                  (router.route !== "/" &&
                  menuItem.path.indexOf(router.route) !== -1
                    ? "mobile-nav__list-item_active"
                    : "") +
                  (router.route === "/" && menuItem.path === router.route
                    ? "mobile-nav__list-item_active"
                    : "")
                }
              >
                {menuItem.path === "/basket" && !!quantity && (
                  <span className={"basket-lines"}>
                    <span>{quantity}</span>
                  </span>
                )}
                <Link
                  aria-label={menuItem.label}
                  href={menuItem.path}
                  className="mobile-nav__list-link"
                >
                  <SVG svg={menuItem.icon} />
                  <span>{menuItem.name}</span>
                </Link>
              </li>
            ))}
          </ul>
        </menu>
      </div>
    </section>
  );
}

export default MobileNavigation;
